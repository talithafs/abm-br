package abm.agents;

import java.util.ArrayList;

import abm.Controller;
import abm.helpers.Utils;

public class UsedMachine extends Machine {

	private int usedCapacity = 0;
	private float usedWages = 0 ;
	private ArrayList<EmployedConsumer> operators ;
	
	public UsedMachine(int capacity, float maxWages) {
		super(capacity, maxWages);
		this.operators = new ArrayList<EmployedConsumer>();
	}

	public ArrayList<EmployedConsumer> getOperators() {
		return operators;
	}

	public void addOperator(EmployedConsumer operator) {
		updateOperation(operator.getWage()); 
		this.operators.add(operator);
	}
	
	public void removeOperator(EmployedConsumer operator) {
		updateOperation(operator.getWage());
		this.operators.remove(operator);
	}
	
	private void updateOperation(float wage) {
		
		float minWage = Controller.getInstance().getMinWage() ;
		float minWages = wage/minWage ;
		
		if(wage < 0) {
			this.usedWages -= minWages ;
		}
		else if(wage > 0) {
			this.usedWages += minWages ;
		}
		else {
			//warning
		}
		
		this.usedCapacity = (int) ((this.capacity*this.usedWages)/this.maxWages) ; 
	}
	

	public int getUsedCapacity() {
		return usedCapacity;
	}

	public void setUsedCapacity(int usedCapacity) {
		this.usedCapacity = usedCapacity;
	}

	public float getUsedWages() {
		return usedWages;
	}

	public void setUsedWages(int usedWages) {
		this.usedWages = usedWages;
	}
	
	@Override
	public String toString() {
		
		String strAgent = super.toString() ;
		
		Integer usedCapacity = this.usedCapacity ;
		Float usedWages = this.usedWages ;

		String[][] fields = { { "Used Capacity", usedCapacity.toString()}, 
							{"Used Wages", usedWages.toString()} } ;
		
	    return strAgent + Utils.getComponentDescriptor(fields, false) ;
	}
	
}
